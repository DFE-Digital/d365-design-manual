{% set powerpages_sections = [
  { title: "Overview", url: pages['powerpages'].url, key: "overview" },
  { title: "Getting started", url: pages['powerpages/getting-started'].url, key: "getting-started" },
  { title: "Styles", url: pages['powerpages/styles'].url, key: "styles" },
  { title: "Components", url: pages['powerpages/components'].url, key: "components" },
  { title: "Patterns", url: pages['powerpages/patterns'].url, key: "patterns" }
] %}

{% set getting_started = [
  pages["powerpages/getting-started/branding-standards"],
  pages["powerpages/getting-started/pre-requisites"],
  pages["powerpages/getting-started/import-website-template"]
] %}

{% set components = [
  pages["powerpages/components/attachment"],
  pages["powerpages/components/card"],
  pages["powerpages/components/checkboxes"],
  pages["powerpages/components/chevron-card"],
  pages["powerpages/components/contents-list"],
  pages["powerpages/components/dashboard"],
  pages["powerpages/components/date-input"],
  pages["powerpages/components/email-input"],
  pages["powerpages/components/feedback"],
  pages["powerpages/components/filter-panel"],
  pages["powerpages/components/loading-spinner"],
  pages["powerpages/components/number-input"],
  pages["powerpages/components/radios"],
  pages["powerpages/components/search"],
  pages["powerpages/components/select"],
  pages["powerpages/components/sidebar"],
  pages["powerpages/components/sortable-table"],
  pages["powerpages/components/sub-navigation"],
  pages["powerpages/components/telephone-input"],
  pages["powerpages/components/textarea"],
  pages["powerpages/components/text-input"],
  pages["powerpages/components/timeline"]
] %}

{% set styles = [
  pages["powerpages/styles/layout"]
] %}

{% set patterns = [
  pages["powerpages/patterns/apply-sort-and-filters"],
  pages["powerpages/patterns/custom-errors"],
  pages["powerpages/patterns/back-link"],
  pages["powerpages/patterns/phase-banner"],
  pages["powerpages/patterns/page-heading"],
  pages["powerpages/patterns/caption-page-heading"],
  pages["powerpages/patterns/crm-helper-framework"]
] %}

{# Determine which section is currently active #}
{% set currentSection = "overview" %}
{% if currentPath | contains(pages['powerpages/getting-started'].url) %}
  {% set currentSection = "getting-started" %}
{% elseif currentPath | contains(pages['powerpages/styles'].url) %}
  {% set currentSection = "styles" %}
{% elseif currentPath | contains(pages['powerpages/components'].url) %}
  {% set currentSection = "components" %}
{% elseif currentPath | contains(pages['powerpages/patterns'].url) %}
  {% set currentSection = "patterns" %}
{% endif %}

{# Power Pages Section Navigation - shown on all Power Pages pages with side nav #}
<nav aria-label="Power Pages sections" class="dfe-vertical-nav govuk-!-margin-bottom-6">
  <h2 class="govuk-heading-s govuk-!-margin-bottom-2">Power Pages</h2>
  <ul class="dfe-vertical-nav__section">
    {% for section in powerpages_sections %}
    <li class="dfe-vertical-nav__section-item {% if section.key == currentSection %}dfe-vertical-nav__section-item--current{% endif %}">
      <a class="dfe-vertical-nav__link govuk-link govuk-link--no-visited-state govuk-link--no-underline" href="{{ section.url }}">{{ section.title }}</a>
    </li>
    {% endfor %}
  </ul>
</nav>

{# Section-specific navigation - items within the current section #}
{% if currentPath | contains(pages['powerpages/getting-started'].url) and currentPath != pages['powerpages/getting-started'].url %}
<nav aria-label="Getting Started Menu" class="dfe-vertical-nav">
  <h2 class="govuk-heading-s govuk-!-margin-bottom-2">In this section</h2>
  <ul class="dfe-vertical-nav__section" id="side-navigation">
    {% for page in getting_started %}
    <li class="dfe-vertical-nav__section-item {% if currentPath | contains(page.url) %}dfe-vertical-nav__section-item--current{% endif %}">
      <a class="dfe-vertical-nav__link govuk-link govuk-link--no-visited-state govuk-link--no-underline" href="{{ page.url }}">{{ page.title }}</a>
    </li>
    {% endfor %}
  </ul>
</nav>
{% elseif currentPath | contains(pages['powerpages/components'].url) and currentPath != pages['powerpages/components'].url %}
<nav aria-label="Components Menu" class="dfe-vertical-nav">
  <h2 class="govuk-heading-s govuk-!-margin-bottom-2">In this section</h2>
  <ul class="dfe-vertical-nav__section" id="side-navigation">
    {% for page in components %}
    <li class="dfe-vertical-nav__section-item {% if currentPath | contains(page.url) %}dfe-vertical-nav__section-item--current{% endif %}">
      <a class="dfe-vertical-nav__link govuk-link govuk-link--no-visited-state govuk-link--no-underline" href="{{ page.url }}">{{ page.title }}</a>
    </li>
    {% endfor %}
  </ul>
</nav>
{% elseif currentPath | contains(pages['powerpages/styles'].url) and currentPath != pages['powerpages/styles'].url %}
<nav aria-label="Styles Menu" class="dfe-vertical-nav">
  <h2 class="govuk-heading-s govuk-!-margin-bottom-2">In this section</h2>
  <ul class="dfe-vertical-nav__section" id="side-navigation">
    {% for page in styles %}
    <li class="dfe-vertical-nav__section-item {% if currentPath | contains(page.url) %}dfe-vertical-nav__section-item--current{% endif %}">
      <a class="dfe-vertical-nav__link govuk-link govuk-link--no-visited-state govuk-link--no-underline" href="{{ page.url }}">{{ page.title }}</a>
    </li>
    {% endfor %}
  </ul>
</nav>
{% elseif currentPath | contains(pages['powerpages/patterns'].url) and currentPath != pages['powerpages/patterns'].url %}
<nav aria-label="Patterns Menu" class="dfe-vertical-nav">
  <h2 class="govuk-heading-s govuk-!-margin-bottom-2">In this section</h2>
  <ul class="dfe-vertical-nav__section" id="side-navigation">
    {% for page in patterns %}
    <li class="dfe-vertical-nav__section-item {% if currentPath | contains(page.url) %}dfe-vertical-nav__section-item--current{% endif %}">
      <a class="dfe-vertical-nav__link govuk-link govuk-link--no-visited-state govuk-link--no-underline" href="{{ page.url }}">{{ page.title }}</a>
    </li>
    {% endfor %}
  </ul>
</nav>
{% endif %}