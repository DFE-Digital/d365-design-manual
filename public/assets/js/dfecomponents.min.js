!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.DfEComponents=e()}(this,function(){var a={nodeListForEach:function(t,e){if(window.NodeList.prototype.forEach)return t.forEach(e);for(var a=0;a<t.length;a++)e.call(window,t[a],a,t)},initAll:function(t){var t=void 0!==(t=void 0!==t?t:{}).scope?t.scope:document,e=t.querySelectorAll('[data-module="dfe-sortable-table"]'),e=(a.nodeListForEach(e,function(t){new a.SortableTable({table:t})}),t.querySelectorAll('[data-module="dfe-sortable-table"]'));a.nodeListForEach(e,function(t){new a.SortableTable({table:t})})},SortableTable:function(t){this.table=$(t.table),this.table.data("dfe-search-toggle-initialised")||(this.table.data("dfe-search-toggle-initialised",!0),this.setupOptions(t),this.body=this.table.find("tbody"),this.createHeadingButtons(),this.createStatusBox(),this.initialiseSortedColumn(),this.table.on("click","th button",$.proxy(this,"onSortButtonClick")))}};return a.SortableTable.prototype.setupOptions=function(t){this.statusMessage=(t=t||{}).statusMessage||"Sort by %heading% (%direction%)",this.ascendingText=t.ascendingText||"ascending",this.descendingText=t.descendingText||"descending"},a.SortableTable.prototype.createHeadingButtons=function(){for(var t,e=this.table.find("thead th"),a=0;a<e.length;a++)(t=$(e[a])).attr("aria-sort")&&this.createHeadingButton(t,a)},a.SortableTable.prototype.createHeadingButton=function(t,e){var a=t.text(),e=$('<button type="button" data-index="'+e+'">'+a+"</button>");t.text(""),t.append(e)},a.SortableTable.prototype.createStatusBox=function(){this.status=$('<div aria-live="polite" role="status" aria-atomic="true" class="govuk-visually-hidden" />'),this.table.parent().append(this.status)},a.SortableTable.prototype.initialiseSortedColumn=function(){var o=this.getTableRowsArray();this.table.find("th").filter('[aria-sort="ascending"], [aria-sort="descending"]').first().each((t,e)=>{var a=$(e).attr("aria-sort"),e=$(e).find("button").attr("data-index"),e=this.sort(o,e,a);this.addRows(e)})},a.SortableTable.prototype.onSortButtonClick=function(t){var e=t.currentTarget.getAttribute("data-index"),a=$(t.currentTarget).parent().attr("aria-sort"),a="none"===a||"descending"===a?"ascending":"descending",o=this.getTableRowsArray(),o=this.sort(o,e,a);this.addRows(o),this.removeButtonStates(),this.updateButtonState($(t.currentTarget),a)},a.SortableTable.prototype.updateButtonState=function(t,e){t.parent().attr("aria-sort",e);var a=this.statusMessage;a=(a=a.replace(/%heading%/,t.text())).replace(/%direction%/,this[e+"Text"]),this.status.text(a)},a.SortableTable.prototype.removeButtonStates=function(){this.table.find("thead th").attr("aria-sort","none")},a.SortableTable.prototype.addRows=function(t){for(var e=0;e<t.length;e++)this.body.append(t[e])},a.SortableTable.prototype.getTableRowsArray=function(){for(var t=[],e=this.body.find("tr"),a=0;a<e.length;a++)t.push(e[a]);return t},a.SortableTable.prototype.sort=function(t,a,o){return t.sort($.proxy(function(t,e){t=$(t).find("td,th").eq(a),e=$(e).find("td,th").eq(a),t=this.getCellValue(t),e=this.getCellValue(e);return"ascending"===o?t<e?-1:e<t?1:0:e<t?-1:t<e?1:0},this))},a.SortableTable.prototype.getCellValue=function(t){var e=(e=t.attr("data-sort-value"))||t.html();return e=$.isNumeric(e)?parseInt(e,10):e},a});