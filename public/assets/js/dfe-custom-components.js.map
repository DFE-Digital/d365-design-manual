{
  "version": 3,
  "sources": ["../../../../../../app/assets/js/dfe-custom-components.js"],
  "sourcesContent": ["const DfEComponents = {};\r\n\r\nDfEComponents.nodeListForEach = function(nodes, callback) {\r\n  if (window.NodeList.prototype.forEach) {\r\n    return nodes.forEach(callback);\r\n  }\r\n  for (let i = 0; i < nodes.length; i++) {\r\n    callback.call(window, nodes[i], i, nodes);\r\n  }\r\n};\r\n\r\nDfEComponents.initAll = function(options = {}) {\r\n  const scope = options.scope || document;\r\n\r\n  const $sortableTables = scope.querySelectorAll('[data-module=\"dfe-sortable-table\"]');\r\n  DfEComponents.nodeListForEach($sortableTables, function($table) {\r\n    new DfEComponents.SortableTable({ table: $table });\r\n  });\r\n\r\n  const $searchableTables = scope.querySelectorAll('[data-module=\"dfe-searchable-table\"]');\r\n  DfEComponents.nodeListForEach($searchableTables, function($table) {\r\n    new DfEComponents.SearchableTable({ table: $table });\r\n  });\r\n};\r\n\r\nDfEComponents.SortableTable = class {\r\n  constructor(params) {\r\n    this.table = $(params.table);\r\n\r\n    if (this.table.data('dfe-search-toggle-initialised')) {\r\n      return;\r\n    }\r\n\r\n    this.table.data('dfe-search-toggle-initialised', true);\r\n\r\n    this.setupOptions(params);\r\n    this.body = this.table.find('tbody');\r\n    this.createHeadingButtons();\r\n    this.createStatusBox();\r\n    this.initialiseSortedColumn();\r\n    this.table.on('click', 'th button', $.proxy(this, 'onSortButtonClick'));\r\n  }\r\n\r\n  setupOptions(params = {}) {\r\n    this.statusMessage = params.statusMessage || 'Sort by %heading% (%direction%)';\r\n    this.ascendingText = params.ascendingText || 'ascending';\r\n    this.descendingText = params.descendingText || 'descending';\r\n  }\r\n\r\n  createHeadingButtons() {\r\n    const headings = this.table.find('thead th');\r\n    for (let i = 0; i < headings.length; i++) {\r\n      const heading = $(headings[i]);\r\n      if (heading.attr('aria-sort')) {\r\n        this.createHeadingButton(heading, i);\r\n      }\r\n    }\r\n  }\r\n\r\n  createHeadingButton(heading, i) {\r\n    const text = heading.text();\r\n    const button = $('<button type=\"button\" data-index=\"' + i + '\">' + text + '</button>');\r\n    heading.text('');\r\n    heading.append(button);\r\n  }\r\n\r\n  createStatusBox() {\r\n    this.status = $('<div aria-live=\"polite\" role=\"status\" aria-atomic=\"true\" class=\"govuk-visually-hidden\" />');\r\n    this.table.parent().append(this.status);\r\n  }\r\n\r\n  initialiseSortedColumn() {\r\n    const rows = this.getTableRowsArray();\r\n    this.table\r\n      .find('th')\r\n      .filter('[aria-sort=\"ascending\"], [aria-sort=\"descending\"]')\r\n      .first()\r\n      .each((index, el) => {\r\n        const sortDirection = $(el).attr('aria-sort');\r\n        const columnNumber = $(el).find('button').attr('data-index');\r\n        const sortedRows = this.sort(rows, columnNumber, sortDirection);\r\n        this.addRows(sortedRows);\r\n      });\r\n  }\r\n\r\n  onSortButtonClick(e) {\r\n    const columnNumber = e.currentTarget.getAttribute('data-index');\r\n    const sortDirection = $(e.currentTarget).parent().attr('aria-sort');\r\n    const newSortDirection = sortDirection === 'none' || sortDirection === 'descending' ? 'ascending' : 'descending';\r\n    const rows = this.getTableRowsArray();\r\n    const sortedRows = this.sort(rows, columnNumber, newSortDirection);\r\n    this.addRows(sortedRows);\r\n    this.removeButtonStates();\r\n    this.updateButtonState($(e.currentTarget), newSortDirection);\r\n  }\r\n\r\n  updateButtonState(button, direction) {\r\n    button.parent().attr('aria-sort', direction);\r\n    let message = this.statusMessage;\r\n    message = message.replace(/%heading%/, button.text());\r\n    message = message.replace(/%direction%/, this[direction + 'Text']);\r\n    this.status.text(message);\r\n  }\r\n\r\n  removeButtonStates() {\r\n    this.table.find('thead th').attr('aria-sort', 'none');\r\n  }\r\n\r\n  addRows(rows) {\r\n    for (let i = 0; i < rows.length; i++) {\r\n      this.body.append(rows[i]);\r\n    }\r\n  }\r\n\r\n  getTableRowsArray() {\r\n    const rows = [];\r\n    const trs = this.body.find('tr');\r\n    for (let i = 0; i < trs.length; i++) {\r\n      rows.push(trs[i]);\r\n    }\r\n    return rows;\r\n  }\r\n\r\n  sort(rows, columnNumber, sortDirection) {\r\n    return rows.sort(\r\n      $.proxy(function(rowA, rowB) {\r\n        const tdA = $(rowA).find('td,th').eq(columnNumber);\r\n        const tdB = $(rowB).find('td,th').eq(columnNumber);\r\n        const valueA = this.getCellValue(tdA);\r\n        const valueB = this.getCellValue(tdB);\r\n        if (sortDirection === 'ascending') {\r\n          return valueA < valueB ? -1 : valueA > valueB ? 1 : 0;\r\n        } else {\r\n          return valueB < valueA ? -1 : valueB > valueA ? 1 : 0;\r\n        }\r\n      }, this)\r\n    );\r\n  }\r\n\r\n  getCellValue(cell) {\r\n    let val = cell.attr('data-sort-value') || cell.html();\r\n    if ($.isNumeric(val)) {\r\n      val = parseInt(val, 10);\r\n    }\r\n    return val;\r\n  }\r\n};\r\n\r\nDfEComponents.SearchableTable = class {\r\n  constructor(params) {\r\n    this.table = $(params.table);\r\n\r\n    if (this.table.data('dfe-search-toggle-initialised')) {\r\n      return;\r\n    }\r\n\r\n    this.table.data('dfe-search-toggle-initialised', true);\r\n\r\n    this.setupOptions(params);\r\n    this.body = this.table.find('tbody');\r\n    this.createStatusBox();\r\n    this.initialiseSortedColumn();\r\n    this.table.on('click', 'th button', $.proxy(this, 'onSortButtonClick'));\r\n\r\n    const searchInput = document.getElementById('searchInput');\r\n    const table = document.getElementById('filterTable');\r\n    const trArray = Array.prototype.slice.call(table.querySelectorAll('tbody tr'));\r\n\r\n    const filterTable = (event) => {\r\n      const searchTerm = event.target.value.toLowerCase();\r\n      trArray.forEach((row) => {\r\n        row.classList.add('hidden');\r\n        const tdArray = Array.prototype.slice.call(row.getElementsByTagName('td'));\r\n        tdArray.forEach((cell) => {\r\n          if (cell.innerText.toLowerCase().indexOf(searchTerm) > -1) {\r\n            row.classList.remove('hidden');\r\n          }\r\n        });\r\n      });\r\n    };\r\n\r\n    if (searchInput) {\r\n      searchInput.addEventListener('input', filterTable);\r\n    }\r\n  }\r\n\r\n  setupOptions(params = {}) {\r\n    this.statusMessage = params.statusMessage || 'Searching %searchValue%';\r\n  }\r\n\r\n  createStatusBox() {\r\n    this.status = $('<div aria-live=\"polite\" role=\"status\" aria-atomic=\"true\" class=\"govuk-visually-hidden\" />');\r\n    this.table.parent().append(this.status);\r\n  }\r\n\r\n  initialiseSortedColumn() {\r\n    const rows = this.getTableRowsArray();\r\n    this.table\r\n      .find('th')\r\n      .filter('[aria-sort=\"ascending\"], [aria-sort=\"descending\"]')\r\n      .first()\r\n      .each((index, el) => {\r\n        const sortDirection = $(el).attr('aria-sort');\r\n        const columnNumber = $(el).find('button').attr('data-index');\r\n        const sortedRows = this.sort(rows, columnNumber, sortDirection);\r\n        this.addRows(sortedRows);\r\n      });\r\n  }\r\n\r\n  onSortButtonClick(e) {\r\n    const columnNumber = e.currentTarget.getAttribute('data-index');\r\n    const sortDirection = $(e.currentTarget).parent().attr('aria-sort');\r\n    const newSortDirection = sortDirection === 'none' || sortDirection === 'descending' ? 'ascending' : 'descending';\r\n    const rows = this.getTableRowsArray();\r\n    const sortedRows = this.sort(rows, columnNumber, newSortDirection);\r\n    this.addRows(sortedRows);\r\n    this.removeButtonStates();\r\n    this.updateButtonState($(e.currentTarget), newSortDirection);\r\n  }\r\n\r\n  updateButtonState(button, direction) {\r\n    button.parent().attr('aria-sort', direction);\r\n    let message = this.statusMessage;\r\n    message = message.replace(/%heading%/, button.text());\r\n    message = message.replace(/%direction%/, this[direction + 'Text']);\r\n    this.status.text(message);\r\n  }\r\n\r\n  removeButtonStates() {\r\n    this.table.find('thead th').attr('aria-sort', 'none');\r\n  }\r\n\r\n  addRows(rows) {\r\n    for (let i = 0; i < rows.length; i++) {\r\n      this.body.append(rows[i]);\r\n    }\r\n  }\r\n\r\n  getTableRowsArray() {\r\n    const rows = [];\r\n    const trs = this.body.find('tr');\r\n    for (let i = 0; i < trs.length; i++) {\r\n      rows.push(trs[i]);\r\n    }\r\n    return rows;\r\n  }\r\n\r\n  sort(rows, columnNumber, sortDirection) {\r\n    return rows.sort(\r\n      $.proxy(function(rowA, rowB) {\r\n        const tdA = $(rowA).find('td,th').eq(columnNumber);\r\n        const tdB = $(rowB).find('td,th').eq(columnNumber);\r\n        const valueA = this.getCellValue(tdA);\r\n        const valueB = this.getCellValue(tdB);\r\n        if (sortDirection === 'ascending') {\r\n          return valueA < valueB ? -1 : valueA > valueB ? 1 : 0;\r\n        } else {\r\n          return valueB < valueA ? -1 : valueB > valueA ? 1 : 0;\r\n        }\r\n      }, this)\r\n    );\r\n  }\r\n\r\n  getCellValue(cell) {\r\n    let val = cell.attr('data-sort-value') || cell.html();\r\n    if ($.isNumeric(val)) {\r\n      val = parseInt(val, 10);\r\n    }\r\n    return val;\r\n  }\r\n};\r\n\r\nexport { DfEComponents };"],
  "mappings": "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",
  "names": ["DfEComponents", "nodes", "callback", "i", "options", "scope", "$sortableTables", "$table", "$searchableTables", "params", "headings", "heading", "text", "button", "rows", "index", "el", "sortDirection", "columnNumber", "sortedRows", "e", "newSortDirection", "direction", "message", "trs", "rowA", "rowB", "tdA", "tdB", "valueA", "valueB", "cell", "val", "searchInput", "table", "trArray", "filterTable", "event", "searchTerm", "row"]
}
